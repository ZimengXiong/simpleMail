# Single canonical template for both:
# - local dev (.env.dev used by scripts/dev.sh)
# - docker deployment (.env)
#
# For docker deployment, run after copying:
#   scripts/bootstrap-env.sh .env

# ------------------------------
# User-Configured Values
# ------------------------------
# Required for app access/auth:
APP_BASE_URL=http://localhost:3000
FRONTEND_BASE_URL=http://localhost:5173

OIDC_ISSUER_URL=http://localhost:8080/realms/simplemail
OIDC_CLIENT_ID=simplemail-web
OIDC_JWKS_URI=
OIDC_ALLOW_INSECURE_HTTP=false
# Single-user mode: set exactly one allowed email.
OIDC_ALLOWED_EMAILS=demo@local.test
OIDC_REQUIRED_SUBJECT=
OIDC_ALLOWED_ALGS=RS256
OIDC_REQUIRE_EMAIL_VERIFIED=false

# Frontend OIDC runtime config.
VITE_OIDC_ISSUER_URL=http://localhost:8080/realms/simplemail
VITE_OIDC_CLIENT_ID=simplemail-web
VITE_OIDC_SCOPES=openid profile email

# Optional Google OAuth / Gmail push.
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
GOOGLE_REDIRECT_URI=http://localhost:3000/api/oauth/google/callback
GMAIL_PUSH_ENABLED=false
GMAIL_PUSH_TOPIC_NAME=
GMAIL_PUSH_WEBHOOK_PATH=/api/gmail/push
GMAIL_PUSH_WEBHOOK_AUDIENCE=
GMAIL_PUSH_SERVICE_ACCOUNT_EMAIL=

# Optional release image selection.
SIMPLEMAIL_VERSION=latest
SIMPLEMAIL_BACKEND_REPOSITORY=docker.io/zimengxiong/simplemail-backend
SIMPLEMAIL_CLIENT_REPOSITORY=docker.io/zimengxiong/simplemail-client

# ------------------------------
# Bootstrapped / Internal Values
# ------------------------------
# scripts/bootstrap-env.sh generates/normalizes these for docker deployment.
DATABASE_URL=postgres://simplemail:simplemail@localhost:5432/simplemail
POSTGRES_DB=simplemail
POSTGRES_USER=simplemail
POSTGRES_PASSWORD=simplemail
API_ADMIN_TOKEN=

# Runtime defaults.
PORT=3000
NODE_ENV=development
OAUTH_CALLBACK_PATH=/oauth/callback
ALLOW_ADMIN_USER_BOOTSTRAP=false

SEAWEED_S3_ENDPOINT=http://localhost:8333
SEAWEED_REGION=us-east-1
SEAWEED_BUCKET=simplemail
SEAWEED_ACCESS_KEY_ID=
SEAWEED_SECRET_ACCESS_KEY=
SEAWEED_FORCE_PATH_STYLE=true

# Advanced sync tuning.
SYNC_USE_IDLE=true
IDLE_POLL_INTERVAL_MS=15000
DEFAULT_MAILBOX=INBOX
SYNC_FLAG_SYNC_WINDOW=256
SYNC_OPERATION_TIMEOUT_MS=120000
SYNC_FULL_RECONCILE_INTERVAL_MS=86400000
SYNC_RECENT_RECONCILE_UID_WINDOW=2000
SYNC_SOURCE_FETCH_BATCH_SIZE=200
SYNC_SYNC_CLAIM_STALE_MS=180000
SYNC_SYNC_CLAIM_HEARTBEAT_STALE_MS=45000
GMAIL_SYNC_CONCURRENCY=4
GMAIL_BOOTSTRAP_METADATA_ONLY=true
GMAIL_BOOTSTRAP_CONCURRENCY=10
GMAIL_BACKGROUND_HYDRATE_BATCH_SIZE=200
GMAIL_BACKGROUND_HYDRATE_CONCURRENCY=4
SYNC_EVENTS_RETENTION_DAYS=14
SYNC_EVENTS_PRUNE_BATCH_SIZE=2000
SYNC_EVENTS_PRUNE_MAX_BATCHES=3
SYNC_EVENTS_PRUNE_INTERVAL_MS=300000

# Optional security/scanning features.
CLAMAV_ENABLED=false
CLAMAV_HOST=clamd
CLAMAV_PORT=3310
CLAMAV_TIMEOUT_MS=15000
CLAMAV_ATTACHMENT_MAX_BYTES=20971520
CLAMAV_SCAN_ON_INGEST=true

WEB_PUSH_ENABLED=false
VAPID_PUBLIC_KEY=
VAPID_PRIVATE_KEY=
VAPID_EMAIL=mailto:admin@example.com
ALLOW_INSECURE_MAIL_TRANSPORT=false
ALLOW_PRIVATE_NETWORK_TARGETS=false
